@startuml
actor Admin
boundary MembershipUI
control MembershipController
entity MonthlyTicket
entity Vehicles
entity Customers

Admin -> MembershipUI: Chọn "Hủy vé tháng"
MembershipUI -> MembershipController: cancelMonthlyTicket(ticketId)

MembershipController -> MonthlyTicket: findById(ticketId)
alt Không tìm thấy vé
  MembershipController -> MembershipUI: showError("Không tìm thấy vé tháng")
  return
end

MembershipController -> MonthlyTicket: expiredDurationMonths(now)
MonthlyTicket --> MembershipController: nMonths

alt nMonths <= 12
  MembershipController -> MembershipUI: showError("Vé chưa ngưng quá 12 tháng - không thuộc diện hủy tự động")
  return
else nMonths > 12
  MembershipController -> MonthlyTicket: cancel(now, reason="Expired > 12 months")
  MonthlyTicket --> MembershipController: canceled
  MembershipController -> MembershipUI: showSuccess("Đã hủy vé tháng", status=CANCELED)
end
@enduml
